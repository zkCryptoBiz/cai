(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[1232],{45189:function(e,t,i){e.exports=i(10145)},10145:function(e,t){!function(e){"use strict";e.stringify=function e(t){function i(e){return/[^\w-.]/.test(e)?e.replace(/[^\w-.]/g,(function(e){return"$"===e?"!":(e=e.charCodeAt(0))<256?"*"+("00"+e.toString(16)).slice(-2):"**"+("0000"+e.toString(16)).slice(-4)})):e}var a;switch(typeof t){case"number":return isFinite(t)?"~"+t:"~null";case"boolean":return"~"+t;case"string":return"~'"+i(t);case"object":if(!t)return"~null";if(a=[],Array.isArray(t)){for(var o=0;o<t.length;o++)a[o]=e(t[o])||"~null";return"~("+(a.join("")||"~")+")"}for(var s in t)if(t.hasOwnProperty(s)){var n=e(t[s]);n&&a.push(i(s)+n)}return"~("+a.join("~")+")";default:return}};var t={true:!0,false:!1,null:null};e.parse=function(e){if(!e)return e;e=e.replace(/%(25)*27/g,"'");var i=0,a=e.length;function o(t){if(e.charAt(i)!==t)throw new Error("bad JSURL syntax: expected "+t+", got "+(e&&e.charAt(i)));i++}function s(){for(var t,o=i,s="";i<a&&"~"!==(t=e.charAt(i))&&")"!==t;)switch(t){case"*":o<i&&(s+=e.substring(o,i)),"*"===e.charAt(i+1)?(s+=String.fromCharCode(parseInt(e.substring(i+2,i+6),16)),o=i+=6):(s+=String.fromCharCode(parseInt(e.substring(i+1,i+3),16)),o=i+=3);break;case"!":o<i&&(s+=e.substring(o,i)),s+="$",o=++i;break;default:i++}return s+e.substring(o,i)}return function n(){var r,c,l;switch(o("~"),c=e.charAt(i)){case"(":if(i++,"~"===e.charAt(i))if(r=[],")"===e.charAt(i+1))i++;else do{r.push(n())}while("~"===e.charAt(i));else if(r={},")"!==e.charAt(i))do{r[s()]=n()}while("~"===e.charAt(i)&&++i);o(")");break;case"'":i++,r=s();break;default:for(l=i++;i<a&&/[^)~]/.test(e.charAt(i));)i++;var u=e.substring(l,i);if(/[\d\-]/.test(c))r=parseFloat(u);else if(void 0===(r=t[u]))throw new Error("bad value keyword: "+u)}return r}()},e.tryParse=function(t,i){try{return e.parse(t)}catch(e){return i}}}(t)},41253:function(e,t,i){"use strict";i.r(t),i.d(t,{AUTH_RESULT_REASON:function(){return D.qd},BIEvents:function(){return L},INTERACTIONS:function(){return D.sH},PrivacyStatus:function(){return fe.lS},PrivacyStatusStatus:function(){return N},Role:function(){return I},SiteMembersApiSymbol:function(){return _.Np},Status:function(){return A},isLoginAcceptableError:function(){return O.qi},isSignupAcceptableError:function(){return O.NU},memberDetailsFromDTO:function(){return O.Yv},page:function(){return xe},site:function(){return $e}});var a=i(77748),o=i(20590),s=i(32777),n=i(32166),r=i(87711),c=i(6623),l=i(9492),u=i(75396),d=i(10553),g=i(79435),m=i(39063),p=i(82658),h=i(46745),S=i(63386),b=i(71085),E=i(73896),f=i(45117),C=i(45156),w=i(45189),P=i.n(w);var y=i(62155),D=i(66397),_=i(19889);class v{constructor(e,t,i,a,o){this.propsStore=e,this.structureApi=t,this.siteScrollBlocker=i,this.browserWindow=a,this.cyclicTabbing=o,this.prevCompIds=[]}async displayDialog(e,t,i,a={},o){const s=async()=>{(0,p.fU)(this.browserWindow)||(this.activeElementBeforeShowDialog=this.browserWindow.document.activeElement);const a=(0,y.uniqueId)(_.RG);this.propsStore.update({[a]:{...t,...i}}),this.currentCompId&&this.cyclicTabbing.disableCyclicTabbing(this.currentCompId),this.cyclicTabbing.enableCyclicTabbing(a),await this.structureApi.addComponentToDynamicStructure(a,{componentType:e,components:[]}),this.currentCompId&&(o?this.prevCompIds.push(this.currentCompId):(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId))),this.siteScrollBlocker.setSiteScrollingBlocked(!0,a),this.currentCompId=a},{shouldWaitForAppDidMount:n,registerToAppDidMount:r}=a;n&&r?r(s):await s()}hideDialog(e){if(this.currentCompId){if(this.removeComponentFromDynamicStructure(this.currentCompId),e)for(;this.prevCompIds.length>0;)this.removeComponentFromDynamicStructure(this.prevCompIds.pop());this.currentCompId=this.prevCompIds.pop()}(0,p.fU)(this.browserWindow)||(this.activeElementBeforeShowDialog?.focus(),this.activeElementBeforeShowDialog=null)}removeComponentFromDynamicStructure(e){this.structureApi.removeComponentFromDynamicStructure(e),this.siteScrollBlocker.setSiteScrollingBlocked(!1,e),this.cyclicTabbing.disableCyclicTabbing(e)}}var N,A,I;!function(e){e.UNKNOWN="UNKNOWN",e.PRIVATE="PRIVATE",e.PUBLIC="PUBLIC"}(N||(N={})),function(e){e.UNKNOWN="UNKNOWN",e.PENDING="PENDING",e.APPROVED="APPROVED",e.BLOCKED="BLOCKED",e.OFFLINE="OFFLINE"}(A||(A={})),function(e){e.UNDEFINED_ROLE="UNDEFINED_ROLE",e.MEMBER="MEMBER",e.OWNER="OWNER",e.CONTRIBUTOR="CONTRIBUTOR"}(I||(I={}));var O=i(65788),T=i(8145),R=i(98323);const L=({sessionManager:e,businessLogger:t,wixBiSession:i,viewMode:a,language:o})=>{const s=(t,s)=>({biToken:i.msId,context:t,ts:k(i),viewmode:a,visitor_id:e.getVisitorId(),site_member_id:e.getSiteMemberId(),vsi:i.viewerSessionId,site_settings_lng:o.siteLanguage,browser_lng:o.userLanguage,lng_mismatch:o.siteLanguage!==o.userLanguage,layout:s});return{loginOrSignUpDialogLoaded:(e,i="fullscreen")=>{t.logger.log({src:5,evid:658,...s(e,i)},{endpoint:"site-members"})},closingDialog:(e,i="fullscreen")=>{t.logger.log({src:5,evid:602,form_type:"default",...s(e,i)},{endpoint:"site-members"})},emailAuthSubmitClicked:(e,i)=>{t.logger.log({src:5,evid:603,form_type:"default",...s(e,i)},{endpoint:"site-members"})},siteMembersFeatureLoaded:()=>{t.logger.log({src:5,evid:698,...s()},{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:()=>{t.logger.log({src:5,evid:699,...s()},{endpoint:"site-members"})},siteMembersEmailConfirmationNewMembersModalLoad:()=>{t.logger.log({src:5,evid:1809,...s()},{endpoint:"site-members"})},siteMembersEmailConfirmationSendCodeClick:()=>{t.logger.log({src:5,evid:1810,...s()},{endpoint:"site-members"})},siteMembersEmailConfirmationOnResendCodeClick:()=>{t.logger.log({src:5,evid:1811,...s()},{endpoint:"site-members"})}}},k=e=>{const t=e.initialTimestamp||0;return Date.now()-t},U={isCloseable:!0,returnPages:!1};class M{constructor(e,t){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e,this.onReset=t,this.config=U}async openPopupPage(e,t){const i=this.shouldRunCustomPopupCloseCallback;this.preventCustomPopupCloseCallback(),await(this.popups?.open(e,(()=>{this.shouldRunCustomPopupCloseCallback&&(this.rejectAuthenticationRequest(),t&&t())}))),this.shouldRunCustomPopupCloseCallback=i}preventCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!1}allowCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!0}assignRequestAuthenticationRejection(e){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||e}assignRequestAuthenticationResolveInstance(e){this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}assignRequestAuthenticationPromise(e,t){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||t,this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}rejectAuthenticationRequest(){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationRejectInstance(D.qd.CANCELED),this.reset())}resolveAuthenticationRequest(e){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationResolveInstance(e),this.reset())}setConfig({isCloseable:e=!0,returnPages:t=!1}){this.config={isCloseable:e,returnPages:t}}reset(){this.onReset?.(),this.requestAuthenticationRejectInstance=void 0,this.requestAuthenticationResolveInstance=void 0,this.config=U}}var V,B,F,q,W,$,x,H=i(15772),G=i(73699),j={},K={memberPrivacySettings:"_memberPrivacySettings"},J={updatedDate:"google.protobuf.Timestamp"};function Y(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{"editor.wixapps.net":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"api._api_base_domain_":[{srcPath:"/members/v1/privacy-settings",destPath:""}],"manage._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"editor._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"blocks._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"create.editorx":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"www.wixapis.com":[{srcPath:"/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],_:[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"www._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"*.dev.wix-code.com":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"bo._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"wixbo.ai":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"apps._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}]}}))}!function(e){e.UNKNOWN="UNKNOWN",e.VISIBLE_TO_MEMBERS_ONLY="VISIBLE_TO_MEMBERS_ONLY",e.VISIBLE_TO_ALL="VISIBLE_TO_ALL"}(V||(V={})),function(e){e.UNKNOWN="UNKNOWN",e.NO_ONE="NO_ONE",e.ANYONE="ANYONE"}(B||(B={})),function(e){e.UNKNOWN="UNKNOWN",e.ENABLED="ENABLED",e.DISABLED="DISABLED",e.PENDING="PENDING",e.DEMO="DEMO"}(F||(F={})),function(e){e.OTHER="OTHER",e.FROM_TEMPLATE="FROM_TEMPLATE",e.DUPLICATE_BY_SITE_TRANSFER="DUPLICATE_BY_SITE_TRANSFER",e.DUPLICATE="DUPLICATE",e.OLD_SITE_TRANSFER="OLD_SITE_TRANSFER",e.FLASH="FLASH"}(q||(q={})),function(e){e.UNKNOWN_NAMESPACE="UNKNOWN_NAMESPACE",e.WIX="WIX",e.SHOUT_OUT="SHOUT_OUT",e.ALBUMS="ALBUMS",e.WIX_STORES_TEST_DRIVE="WIX_STORES_TEST_DRIVE",e.HOTELS="HOTELS",e.CLUBS="CLUBS",e.ONBOARDING_DRAFT="ONBOARDING_DRAFT",e.DEV_SITE="DEV_SITE",e.LOGOS="LOGOS",e.VIDEO_MAKER="VIDEO_MAKER",e.PARTNER_DASHBOARD="PARTNER_DASHBOARD",e.DEV_CENTER_COMPANY="DEV_CENTER_COMPANY",e.HTML_DRAFT="HTML_DRAFT",e.SITELESS_BUSINESS="SITELESS_BUSINESS",e.CREATOR_ECONOMY="CREATOR_ECONOMY",e.DASHBOARD_FIRST="DASHBOARD_FIRST",e.ANYWHERE="ANYWHERE",e.HEADLESS="HEADLESS",e.ACCOUNT_MASTER_CMS="ACCOUNT_MASTER_CMS",e.RISE="RISE",e.BRANDED_FIRST="BRANDED_FIRST"}(W||(W={})),function(e){e.UNKNOWN="UNKNOWN",e.TRASH="TRASH",e.DELETED="DELETED",e.PENDING_PURGE="PENDING_PURGE"}($||($={})),function(e){e.UNKNOWN="UNKNOWN",e.ANONYMOUS_VISITOR="ANONYMOUS_VISITOR",e.MEMBER="MEMBER",e.WIX_USER="WIX_USER",e.APP="APP"}(x||(x={}));const z=e=>{const t=e.joinCommunityCheckedByDefault??!0,i=e.privacyNoteType??"CHECKBOX";return t?i:"CHECKBOX"},X=e=>"NOTE"===z(e)||(e.joinCommunityCheckedByDefault??!0),Q=async(e,t)=>{const{data:i}=await e.request(function(e){var t=(0,G.d)(j,{}),i=t.toJSON,a=t.fromJSON,o=(0,G.d)(K,{_memberPrivacySettings:J}).fromJSON;function s(t){var a=t.host,s=i(e);return{entityFqdn:"wix.members.v1.member_privacy_settings",method:"GET",methodFqn:"com.wixpress.members.memberprivacysettings.MemberPrivacySettingsService.GetMemberPrivacySettings",url:Y({protoPath:"/v1/privacy-settings",data:s,host:a}),params:(0,H.bU)(s),transformResponse:o}}return s.fromReq=a,s.__isAmbassador=!0,s}({}),{signedInstance:t});return i.memberPrivacySettings},Z={[A.APPROVED]:"ACTIVE",[A.PENDING]:"PENDING"};var ee=i(85583),te={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_commonListValue",mapValue:"_commonMapValue"},ie={value:"_commonCustomValue"},ae={value:"Map#_commonCustomValue"},oe={value:"_customValue"},se={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_listValue",mapValue:"_mapValue"},ne={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",identityProfile:"_identityProfile"},re={customFields:"_customField"},ce={value:"_customValue"},le={},ue={},de={value:"Map#_customValue"},ge={body:"BYTES"},me={profile:"_identityProfile"},pe={identity:"_identity",additionalData:"Map#_commonCustomValue"};function he(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{_:[{srcPath:"/_api/iam/authentication",destPath:""}],"users._base_domain_":[{srcPath:"/iam/wix/google",destPath:"/v1/sso/callback/root/0e6a50f5-b523-4e29-990d-f37fa2ffdd69"},{srcPath:"/authentication",destPath:""}],"www.wixapis.com":[{srcPath:"/_api/iam/authentication",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}],"wixbo.ai":[{srcPath:"/_api/iam/authentication",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}],"manage._base_domain_":[{srcPath:"/_api/authentication",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}]}}))}var Se={},be={body:"BYTES"};function Ee(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{"manage._base_domain_":[{srcPath:"/_api/cookie",destPath:""}],_:[{srcPath:"/_api/iam/cookie",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/iam/cookie",destPath:""}],"wixbo.ai":[{srcPath:"/_api/iam/cookie",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/cookie",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/iam/cookie",destPath:""}]}}))}var fe=i(82884),Ce={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_commonListValue",mapValue:"_commonMapValue"},we={value:"_commonCustomValue"},Pe={value:"Map#_commonCustomValue"},ye={value:"_customValue"},De={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_listValue",mapValue:"_mapValue"},_e={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",identityProfile:"_identityProfile"},ve={customFields:"_customField"},Ne={value:"_customValue"},Ae={value:"Map#_customValue"},Ie={identity:"_identity",additionalData:"Map#_commonCustomValue"},Oe={};function Te(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{"www.wixapis.com":[{srcPath:"/_api/iam/verification",destPath:""}],_:[{srcPath:"/_api/iam/verification",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/verification",destPath:""}]}}))}function Re(e){var t=(0,G.d)(Oe,{}),i=t.toJSON,a=t.fromJSON,o=(0,G.d)(Ie,{_commonCustomValue:Ce,_commonListValue:we,_commonMapValue:Pe,_customField:ye,_customValue:De,_identity:_e,_identityProfile:ve,_listValue:Ne,_mapValue:Ae}).fromJSON;function s(t){var a=t.host,s=i(e);return{entityFqdn:"wix.iam.verification.v1.start_response",method:"POST",methodFqn:"wix.iam.verification.v1.VerificationService.VerifyDuringAuthentication",url:Te({protoPath:"/v1/auth/verify",data:s,host:a}),data:s,transformResponse:o}}return s.fromReq=a,s.__isAmbassador=!0,s}var Le=i(93425);const ke=(e,t,i)=>{document.cookie=`${e}=;max-age=0`,document.cookie=`${e}=;max-age=0;path=${t}`,document.cookie=`${e}=;domain=${i};max-age=0`,document.cookie=`${e}=;domain=${i};max-age=0;path=${t}`},Ue=(0,a.Og)([(0,a.KT)(o.YG,_.UU),(0,a.KT)(o._K,_.UU),(0,a.KT)(o.wk,_.UU),(0,a.KT)(o.AF,_.UU),s.F,n.Ht,n.TQ,S.i$,r.Ji,r.eZ,n.dn,n.RV,b.Ix,(0,a.lq)(E.j),b.$1,c.F,l.O$,(0,a.lq)(f.KK),(0,a.lq)(C.i),u.t7,d.n,(0,a.lq)(g.Z),(0,a.lq)(R.j),(0,a.lq)(T.U),(0,a.lq)(Le.gB)],((e,t,i,a,o,s,n,r,c,l,u,d,g,S,b,E,f,C,w={trackEvent:()=>0},_,N,A,T,R,k)=>{const U=(0,m.o)(),{loginSocialBarOnSite:V,protectedHomepage:F,smSessionCookie:q,memberInfoAppId:W,membersInfoAppDefId:$,smcollectionId:x,isTemplate:j}=e;let{sm_efCookie:K}=e;const J="22bef345-3c5b-4c18-b782-74d4085112ff",Y=r.getUserSession(),Ce=()=>r.getAppInstanceByAppDefId(J)||"",we=()=>(0,O.YA)(r),Pe=N["specs.thunderbolt.deprecateAppId"],ye=N["specs.ident.usePlatformizedSMAuth"],{smSettings:De,tpaAppDefinitionIds:_e,tpaApplicationIds:ve,tpaPageIds:Ne,policyLinks:Ae,translations:Ie}=t,Oe=Pe?_e[$]:W&&ve[W],{metaSiteId:Te,externalBaseUrl:Le,siteId:Ue,siteRevision:Me}=n.site,Ve=n.requestUrl,Be=n.viewMode,Fe=n.anywhereConfig?.siteId??Ue,qe=n.anywhereConfig?.revision??Me,We=-1!==D.UG.findIndex((e=>d?.navigator?.userAgent?.includes(e))),$e=!We,xe=!We,He=`/_api/wix-sm-webapp/tokens/verify/${Te}/${Fe}`,Ge=`${Le.replace(/\/$/,"")}/api/wix-sm/v1/authorize/${Fe}/pages`,je=`/_api/wix-sm-webapp/tokens/logout/${Te}`,Ke=`/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId=${Te}&collectionId=${x}`,Je="/_api/iam/state-machine-service",Ye=De.smFirstDialogLogin?"login":"signup",{socialLoginFacebookEnabled:ze,socialLoginGoogleEnabled:Xe,termsOfUse:Qe,privacyPolicy:Ze,codeOfConduct:et,customSignUpPageId:tt,customSignInPageId:it}=De,{privacyNoteType:at,joinCommunityCheckedByDefault:ot}=(e=>({privacyNoteType:z(e),joinCommunityCheckedByDefault:X(e)}))(De);let{smToken:st}=e,nt={},rt=q,ct=null,lt=!1;const ut=e=>{ct=e},dt=()=>({registerToAppDidMount:ut,shouldWaitForAppDidMount:!lt}),gt=async()=>{if(N["specs.thunderbolt.getMemberDetailsFromMembersNg"]){const{member:e}=await bt("/_api/members/v1/members/my?fieldsets=FULL",{headers:{authorization:r.getAppInstanceByAppDefId(J)??""}}),{role:t}=await(0,O.hv)((()=>bt(`/api/wix-sm/v1/members/${e?.id}/role`,{headers:{authorization:r.getAppInstanceByAppDefId(J)??""}})),(()=>({role:I.MEMBER})));return(({member:e,role:t})=>{return{id:e?.id??"",contactId:e?.contactId??"",loginEmail:e?.loginEmail??"",imageUrl:e?.profile?.photo?.url??"",nickname:e?.profile?.nickname??"",profilePrivacyStatus:e?.privacyStatus??"",slug:e?.profile?.slug??"",status:(a=e?.status,a?Z[a]??"APPLICANT":"APPLICANT"),creationDate:e?.createdDate??"",lastUpdateDate:e?.updatedDate??"",lastLoginDate:e?.lastLoginDate??"",emailVerified:e?.loginEmailVerified??!1,role:t??"MEMBER",owner:t===I.OWNER,firstName:e?.contact?.firstName??"",lastName:e?.contact?.lastName??"",memberName:(i=e?.contact,`${i?.firstName??""} ${i?.lastName??""}`.trim()),groups:void 0,emails:void 0,phones:void 0,addresses:void 0,labels:void 0,customFields:void 0};var i,a})({member:e,role:t})}const e=`/_api/wix-sm-webapp/member/${st}?collectionId=${x}&metaSiteId=${Te}`,{payload:t}=await bt(e);return(0,O.Yv)(t)},mt={},pt={},ht=L({sessionManager:r,businessLogger:E,wixBiSession:f,viewMode:Be?.toUpperCase(),language:u});ht.siteMembersFeatureLoaded();const St={},bt=(0,O.I5)(o,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":`${qe}`,"x-wix-client-artifact-id":"thunderbolt"}},Ve),Et=(0,ee.u)({isSSR:!1,...N["specs.thunderbolt.siteMembersMultilingualLanguage"]&&u?.isMultilingualEnabled?{multilingualOptions:{isPrimaryLanguage:k?.isOriginalLanguage||!0,locale:k?.currentLanguage.locale??"en",lang:k?.currentLanguage.languageCode??"en"}}:{}}),ft=((e,t)=>{let i;return{canHavePublicMembers:async()=>i||(i=new Promise((async i=>{const a=await Q(e,t()),o=a?.publicMemberCandidates;i(o===B.ANYONE)})),i)}})(Et,Ce),Ct=((e,t,i,a,o)=>new v(e,t,i,a,o))(c,l,S,d,T),wt=new URL(Ve).searchParams,Pt={};wt.forEach(((e,t)=>{Pt[t]=e}));const yt=(e=>{let{query:t}=e;const i=P().tryParse(null==t?void 0:t.headlessExternalUrls,{})??{};return null==i?void 0:i.headlessClientId})({query:Pt}),Dt=((e,t,i,a,o,s)=>{let n;const r="/_serverless/collection-settings-facade/get-settings",c=async()=>n||e(s?`${r}?clientId=${s}`:r,{headers:{"Content-Type":"application/json",authorization:o()},credentials:"omit"}).then((e=>(n=e,n))),l=async()=>c().then((e=>e.collectionSettings));return{getSiteMembersSettings:l,getCaptchaSettings:()=>l().then(O.YG).catch((e=>(t.captureError(e,{tags:{feature:"site-members"}}),i.trackEvent((0,D.SU)(D.WW.ACTIONS.SETTINGS.FAIL)),{invisible:{login:!1,signup:!1},visible:{login:!1,signup:!0}}))),getEnabledConnections:e=>c().then((t=>t.enabledConnections.filter((({appDefId:t})=>!1!==e[t]))??[])),getLoginRedirectUrl:()=>c().then((e=>e.loginUrl)),getLogoutRedirectUrl:()=>c().then((e=>e.logoutUrl))}})(bt,s,w,0,(()=>Ce()),yt),_t=(0,O.bR)(d),vt=(0,O.Ed)(d,U),Nt=new M(C,(async()=>{const e=await Dt.getCaptchaSettings();(e.invisible.login||e.invisible.signup)&&vt.hideCaptchaBadge()})),At=R?.getBsi(),It=At?At.split("|")[0]:"00000000-0000-0000-0000-000000000000",Ot=e=>{s.interactionStarted(D.sH.SOCIAL_APP_LOGIN_WITH_VENDOR(e))},Tt={appDidMount(){ct&&ct(),lt=!0},async handleSocialLoginResponse(e,t,i=!1){const a=D.UI[t]??t;s.interactionStarted(D.sH.SOCIAL_APP_LOGIN),s.interactionEnded(D.sH.SOCIAL_APP_LOGIN),s.interactionEnded(D.sH.SOCIAL_APP_LOGIN_WITH_VENDOR(a)),w.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGIN.SUBMIT,a)),N["specs.thunderbolt.useNewPostLoginRedirect"]||(0,O._y)(d,Ve,{});const o=await Tt.handleIAMLoginResponseV1(e,i);return w.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGIN.SUCCESS,a)),o},async handleIAMLoginResponseV1(e,t=!1){if(e.identity?.status?.name===fe.EH.PENDING){if(ye){if(Ne[D.$m.ADMIN_APPROVAL])throw Nt.rejectAuthenticationRequest(),await g.navigate(D.m2[D.$m.ADMIN_APPROVAL]),new Error(D.qd.CANCELED)}return Tt.showAdminApprovalDialog(e.identity.email?.address??"")}const i=(0,O.N3)(e),a=e.sessionToken,o=(0,O.FB)(e.additionalData?.protectedPages);if((0,O._y)(d,Ve,{sessionToken:a})&&N["specs.thunderbolt.useNewPostLoginRedirect"])return(0,O.yw)();const s=await Tt.applySessionToken(a,i,t&&!o);return{sessionToken:a,member:i,...t?{pages:o??s}:{}}},async promptLogin(e={},t=Nt.config?.isCloseable??!0,i=Nt.config?.returnPages??!1){const{mode:a,modal:o}=e,s="login"===(a??Ye),n=o?"popup":"fullscreen";return j?(await Tt.showNotificationDialog(Ie.templateNotificationTitle,Ie.templateNotificationMessage,Ie.containerOk),Promise.reject(D.qd.CANCELED)):(vt.loadScript(u.userLanguage,D.c8),s?Tt.showLoginDialog({isCloseable:t,displayMode:n,returnPages:i}):Tt.showSignUpDialog({isCloseable:t,displayMode:n,returnPages:i}))},promptForgotPassword(e=!0){return new Promise(((t,i)=>{Nt.assignRequestAuthenticationPromise(t,i);const a={isCloseable:e,directionByLanguage:u.directionByLanguage,translations:Ie},o={async onCloseDialogCallback(){(0,O.Fy)(Ve,d),ht.closingDialog("RequestResetPassword"),Ct.hideDialog(),Nt.rejectAuthenticationRequest()},onSubmitCallback(e){return Tt.sendForgotPasswordEmail(e).then((async()=>{const e=()=>{(0,O.Fy)(Ve,d),Nt.resolveAuthenticationRequest(),i(D.qd.CANCELED)};Tt.showNotificationDialog(Ie.resetPasswordCheckEmailTitle,Ie.resetPasswordCheckEmailText,Ie.resetPasswordOk,e,e)}))}},s=dt();if(ye){const e=Ne[D.$m.FORGOT_PASSWORD];if(e)return C?.open(e).then((()=>{Ct.hideDialog(!0)}))}Ct.displayDialog("RequestPasswordResetDialog",a,o,s)}))},async requestAuthentication(e={}){if(rt)return{success:!0,token:rt,reason:D.qd.ALREADY_LOGGED_IN};try{const t=!F,{sessionToken:i}=await Tt.promptLogin(e,t);return{success:!0,token:i,reason:D.qd.SUCCESS}}catch(e){return{success:!1,reason:e}}},async requestAuthorizedPages(e={}){if(st){return{success:!0,pages:await Tt.authorizeMemberPagesBySignedInstance(Ce())}}try{const t=!F;Nt.setConfig({isCloseable:t,returnPages:!0});const i=await Tt.promptLogin(e,t,!0);return Nt.reset(),{success:!0,pages:i.pages}}catch(e){return{success:!1,reason:e}}},async applySessionToken(e,t,i=!1){if((0,p.fU)(d))throw D.Nw;s.interactionStarted(D.sH.VERIFY_TOKEN);const o=await Et.request(function(e){var t=(0,G.d)(Se,{}),i=t.toJSON,a=t.fromJSON,o=(0,G.d)(be,{}).fromJSON;function s(t){var a=t.host,s=i(e);return{entityFqdn:"wix.iam.cookie.v1.cookie",method:"POST",methodFqn:"wix.iam.cookie.v1.CookieService.CreateSessionCookie",url:Ee({protoPath:"/v1/createSessionCookie",data:s,host:a}),data:s,transformResponse:o,fallback:[{method:"POST",url:Ee({protoPath:"/v1/createSessionCookie",data:s,host:a}),data:s}]}}return s.fromReq=a,s.__isAmbassador=!0,s}({sessionToken:e,protectedPages:i}),{signedInstance:Ce()}).then((e=>e.data)).catch((e=>{throw e.response?.data??e}));var n;if(s.interactionEnded(D.sH.VERIFY_TOKEN),await r.loadNewSession({reason:"memberLogin"}),st=r.getSmToken(),rt=e,nt=t??await Tt.getMemberDetails(),await(n=nt,Promise.all(Object.entries(mt).map((async([e,t])=>{try{if("$$$timeout$$$"===await Promise.race([t(n),(0,O.yy)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}})))),a.export({memberDetails:nt}),i){return(0,O.FB)(o?.protectedPages)}},async authorizeMemberPagesByCookie(){const e=(0,p.fU)(d)?{headers:{cookie:`smSession=${q}`}}:void 0,{authorizedPages:t}=await bt(Ge,e);return t},async authorizeMemberPagesByToken(e){if(e===q)return this.authorizeMemberPagesByCookie();const{payload:t}=await bt(He,{method:"POST",body:`token=${e}`}),{pages:i}=t;return i},async authorizeMemberPagesBySignedInstance(e){const t={headers:{authorization:e}},{authorizedPages:i}=await bt(Ge,t);return i},async getMemberDetails(e=!1){return nt.id&&!e?nt:st?(nt=await gt(),a.export({memberDetails:nt}),e&&await(t=nt,Promise.all(Object.values(St).map((async e=>{try{await e(t)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}})))),nt):null;var t},async sendForgotPasswordMail(e){return this.sendForgotPasswordEmail(e)},async sendForgotPasswordEmail(e){s.interactionStarted(D.sH.RESET_PASSWORD);const t=u.userLanguage,i={url:(0,O.g9)(Ve)??Ve},a=JSON.stringify({language:t,email:e,redirect:i}),o={"Content-Type":"application/json",authorization:Ce()};await bt("/_api/iam/recovery/v1/send-email",{headers:o,method:"POST",body:a}),s.interactionEnded(D.sH.RESET_PASSWORD)},async sendSetPasswordEmail(e,t){const i=await bt("/_api/wix-sm-webapp/members/v1/auth/members/send-set-password-email",{method:"POST",headers:{"Content-Type":"application/json",authorization:Ce()},body:JSON.stringify({email:e,...t?.hideIgnoreMessage?{hideIgnoreMessage:t.hideIgnoreMessage}:{}})});return!!i?.accepted},async changePassword(e,t){const i=encodeURIComponent(e),a=t.startsWith(D.Zq),o=a?"/_api/iam/recovery/v1/recover":Ke,s=a?JSON.stringify({password:e,recovery_token:t}):`newPassword=${i}&forgotPasswordToken=${t}`,n=a?{"Content-Type":"application/json",authorization:Ce()}:void 0;await bt(o,{method:"POST",headers:n,body:s})},async sendEmailVerification(e){return this.resendEmailVerification(e)},async resendEmailVerification(e){await bt(`/_api/wix-sm-webapp/tokens/email/resend/${e}`)},async logout(e){if(!st)return!1;if(N["specs.thunderbolt.logoutOnIAM"]?await Et.request(function(e){var t=(0,G.d)(ue,{}),i=t.toJSON,a=t.fromJSON,o=(0,G.d)(ge,{}).fromJSON;function s(t){var a=t.host,s=i(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"GET",methodFqn:"wix.iam.authentication.v1.AuthenticationService.Logout",url:he({protoPath:"/v1/logout",data:s,host:a}),params:(0,H.bU)(s),transformResponse:o}}return s.fromReq=a,s.__isAmbassador=!0,s}({}),{signedInstance:Ce()}).catch((()=>{w.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGOUT.FAIL))})):await bt(je,{method:"POST"}).catch((()=>{w.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGOUT.FAIL))})),await Promise.all(Object.entries(pt).map((async([e,t])=>{try{if("$$$timeout$$$"===await Promise.race([t(),(0,O.yy)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))),e){const t=`./${e.replace(/^\//,"")}`;await g.navigate(t)}const t=await Tt.getLogoutUrl();return t?d?.location.replace(t):(0,p.fU)(d)||d.document.location.reload(),!(!e&&!t)},registerToUserLogin(e,t=(0,y.uniqueId)("callback")){return mt[t]=e,t},unRegisterToUserLogin(e){delete mt[e]},registerToMemberLogout(e){const t=(0,y.uniqueId)("logout_callback");return pt[t]=e,t},unRegisterToMemberLogout(e){delete pt[e]},registerToMemberDetailsRefresh(e){const t=(0,y.uniqueId)("mdrcb");return St[t]=e,t},unRegisterToMemberDetailsRefresh(e){delete St[e]},async showWelcomeDialog(e=!0){const t={isCloseable:e,translations:Ie},i=b.getParsedUrl(),a={onCloseDialogCallback(){(0,O.Fy)(Ve,d),ht.closingDialog("WelcomeDialog");const e=new URL(Ve).hostname,t=0===e.indexOf("www")?e.substr(3):e;ke("sm_ef","/",t),K="",Ct.hideDialog(),g.navigate(i.href)},onSubmitCallback(){const e=new URL(Ve).hostname,t=0===e.indexOf("www")?e.substr(3):e;ke("sm_ef","/",t),K="",Ct.hideDialog(),Oe&&g.navigate("./account/my-account"),g.navigate(i.href)}};s.interactionStarted(D.sH.WELCOME_DIALOG),s.interactionEnded(D.sH.WELCOME_DIALOG),Ct.displayDialog("WelcomeDialog",t,a)},async showNoPermissionsToPageDialog(e){if(ye){if(Ne[D.$m.NO_PERMISSION])return void g.navigate(D.m2[D.$m.NO_PERMISSION])}const t={onCloseDialogCallback(){(0,O.Fy)(Ve,d),Ct.hideDialog(),e&&e()},onSwitchAccountLinkClick(){Tt.logout()}};Ct.displayDialog("NoPermissionsToPageDialog",{translations:Ie},t)},async navigateToResetPasswordPage(e){if(Ne[D.$m.RESET_PASSWORD]){const t=`${D.m2[D.$m.RESET_PASSWORD]}?resetPasswordToken=${e}`;return await g.navigate(t)}this.showResetPasswordDialog(e)},async showResetPasswordDialog(e){const t=()=>{const e=b.getParsedUrl();return e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),b.pushUrlState(e),e},i={isCloseable:!0,isTermsOfUseNeeded:!(!Qe?.enabled||!Ae.termsOfUse),isPrivacyPolicyNeeded:!(!Ze?.enabled||!Ae.privacyPolicy),termsOfUseLink:Ae.termsOfUse,privacyPolicyLink:Ae.privacyPolicy,directionByLanguage:u.directionByLanguage,translations:Ie},a={onCloseDialogCallback(){(0,O.Fy)(Ve,d),ht.closingDialog("ResetPasswordDialog");const e=t();Ct.hideDialog(),g.navigate(e.href)},async onSubmitCallback(a){try{await Tt.changePassword(a,e),Tt.showNotificationDialog(Ie.resetPasswordSuccessTitle,"",Ie.containerOk,(async()=>{if(e.startsWith(D.Zq)){const e=new URL(Ve).searchParams.get("redirectUrl");if(e)return d?.location.replace(e)}const i=t();await Tt.showLoginDialog(),g.navigate(i.href)}))}catch(e){const t=(0,O.E2)(e).toString();if(t!==D.OQ.RESET_PASSWORD_TOKEN_EXPIRED&&t!==D.OQ.NEW_RESET_PASSWORD_TOKEN_EXPIRED)throw e;if(ye){if(Ne[D.$m.EXPIRED_TOKEN])return void await g.navigate(D.m2[D.$m.EXPIRED_TOKEN])}Tt.showNotificationDialog(Ie.passwordHasExpiredTitle,Ie.passwordHasExpiredText,Ie.passwordHasExpiredOk,(()=>Tt.promptForgotPassword(i.isCloseable).then((()=>{const e=b.getParsedUrl();g.navigate(e.href)}))))}}};Ct.displayDialog("ResetPasswordDialog",i,a,dt())},async showLoggedInResetPasswordDialog(){const e={isCloseable:!0,directionByLanguage:u.directionByLanguage,translations:Ie},t={onCloseDialogCallback(){ht.closingDialog("LoggedInResetPasswordDialog"),Ct.hideDialog()},async onSubmitCallback(){}};Ct.displayDialog("LoggedInResetPasswordDialog",e,t,dt())},async showLoginDialog(e={},t){const{returnPages:i,isCloseable:a,displayMode:o}={isCloseable:!0,displayMode:"fullscreen",returnPages:!1,...e},n=await Dt.getCaptchaSettings();return vt.setCaptchaBadgeVisibility(n.invisible.login),it&&C?.isLightbox(it)?Tt.showCustomAuthenticationDialog(it,i):new Promise((async(e,r)=>{Nt.assignRequestAuthenticationPromise(e,r);const c="Enabled"===N["specs.ShouldForceCaptchaVerificationOnLoginSpec"]||n.visible.login,[l,g]=(0,y.partition)(await Tt.getConnections(),{appDefId:D.ch.PASSWORD}),m=await Tt.getLoginUrl(),p={bsi:It,displayMode:o,language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:a,smCollectionId:x,svSession:Y,biVisitorId:we(),metaSiteId:Te,isEmailLoginEnabled:l.length>0,idps:g,shouldForceCaptchaVerification:!n.invisible.login&&c,isSocialAuthSupported:$e,serverError:t,reportBi:E.reportBi,translations:Ie,externalBaseUrl:Tt.getExternalBaseUrl(),headlessRedirectUrl:m},S={onCloseDialogCallback(){(0,O.Fy)(Ve,d),Ct.hideDialog(),ht.closingDialog("MemberLoginDialog",o),Nt.rejectAuthenticationRequest()},submit(t,a,n){return s.interactionStarted(D.sH.DEFAULT_LOGIN),ht.emailAuthSubmitClicked("MemberLoginDialog",o),Tt.login(t,a,n,i,void 0,!0).then((t=>{s.interactionEnded(D.sH.DEFAULT_LOGIN),Ct.hideDialog(),e(t)})).catch((e=>{throw(0,O.qi)(e)&&s.interactionEnded(D.sH.DEFAULT_LOGIN),e}))},onForgetYourPasswordClick(){Tt.promptForgotPassword(a)},onSwitchDialogLinkClick(){Tt.showSignUpDialog({isCloseable:a,displayMode:o,returnPages:i}).then(e,(()=>{Nt.rejectAuthenticationRequest()}))},onBackendSocialLogin(t,a){return Tt.handleSocialLoginResponse(t,a,i).then((t=>{Ct.hideDialog(),e(t)}))},getHostReadyPayload:()=>({visitorId:we(),svSession:Y}),openCaptcha:(0,h.V1)({captcha:A,userLanguage:u.userLanguage}),reportSocialAuthStarted:Ot};ht.loginOrSignUpDialogLoaded("MemberLoginDialog",o),await Ct.displayDialog("MemberLoginDialog",p,S,dt()),Tt.closeCustomAuthenticationDialogs(!0)}))},async showSignUpDialog(e={},t){const{returnPages:i,isCloseable:a,displayMode:o}={isCloseable:!0,displayMode:"fullscreen",returnPages:!1,...e},n=await Dt.getCaptchaSettings();if(vt.setCaptchaBadgeVisibility(n.invisible.signup),tt&&C?.isLightbox(tt))return Tt.showCustomAuthenticationDialog(tt,i);const r="Enabled"!==N["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&"Enabled"===N["specs.ShouldForceCaptchaVerificationOnSignupSpec"];return new Promise((async(e,c)=>{const l=r||n.visible.signup&&"Enabled"!==N["specs.ShouldPassCaptchaVerificationOnSignupSpec"],[g,m]=(0,y.partition)(await Tt.getConnections(),{appDefId:D.ch.PASSWORD}),p=await Tt.getLoginUrl();Nt.assignRequestAuthenticationPromise(e,c);const S={bsi:It,displayMode:o,language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:a,smCollectionId:x,biVisitorId:we(),svSession:Y,metaSiteId:Te,isSocialAuthSupported:$e,isEmailLoginEnabled:g.length>0,idps:m,isCommunityInstalled:await ft.canHavePublicMembers(),privacyNoteType:at,joinCommunityCheckedByDefault:ot,isTermsOfUseNeeded:!(!Qe?.enabled||!Ae.termsOfUse),isPrivacyPolicyNeeded:!(!Ze?.enabled||!Ae.privacyPolicy),isCodeOfConductNeeded:!(!et?.enabled||!Ae.codeOfConduct),shouldForceCaptchaVerification:!n.invisible.signup&&l,termsOfUseLink:Ae.termsOfUse,privacyPolicyLink:Ae.privacyPolicy,codeOfConductLink:Ae.codeOfConduct,serverError:t,reportBi:E.reportBi,translations:Ie,externalBaseUrl:Tt.getExternalBaseUrl(),headlessRedirectUrl:p},b={onCloseDialogCallback(){(0,O.Fy)(Ve,d),Ct.hideDialog(),ht.closingDialog("SignUpDialog",o),Nt.rejectAuthenticationRequest()},async submit(t,a,n){let r;if(S.isCommunityInstalled){r=("boolean"==typeof n?n:n.isCommunityChecked)?fe.lS.PUBLIC:fe.lS.PRIVATE}const c="boolean"==typeof n?void 0:n?.recaptchaToken;return s.interactionStarted(D.sH.DEFAULT_SIGNUP),ht.emailAuthSubmitClicked("SignUpDialog",o),Tt.register(t,a,void 0,r,!0,i,c,void 0).then((t=>{s.interactionEnded(D.sH.DEFAULT_SIGNUP);const{member:a,sessionToken:o,pages:n}=t;o&&(Ct.hideDialog(!0),e({member:a,sessionToken:o,...i?{pages:n}:{}}))})).catch((e=>{throw(0,O.NU)(e)&&s.interactionEnded(D.sH.DEFAULT_SIGNUP),e}))},onSwitchDialogLinkClick(){Tt.showLoginDialog({isCloseable:a,displayMode:o,returnPages:i}).then(e,(()=>{Nt.rejectAuthenticationRequest()}))},onBackendSocialLogin(t,a){return Tt.handleSocialLoginResponse(t,a,i).then((t=>{Ct.hideDialog(),e(t)}))},getHostReadyPayload:()=>({visitorId:we(),svSession:Y}),openCaptcha:(0,h.V1)({captcha:A,userLanguage:u.userLanguage}),reportSocialAuthStarted:Ot};ht.loginOrSignUpDialogLoaded("SignUpDialog",o),await Ct.displayDialog("SignUpDialog",S,b,dt()),Tt.closeCustomAuthenticationDialogs(!0)}))},async hideAuthDialog(){console.warn("hideAuthDialog is not supported")},async showNotificationDialog(e,t,i,a=(()=>0),o=(()=>0)){const s={isCloseable:!0,title:e,description:t,okButtonText:i,translations:Ie},n={onCloseDialogCallback(){(0,O.Fy)(Ve,d),ht.closingDialog("NotificationDialog"),Ct.hideDialog(),o()},onOkButtonClick(){Ct.hideDialog(),a()}};await Ct.displayDialog("NotificationDialog",s,n)},async showConfirmationEmailDialog(e,t=!0){return new Promise(((i,a)=>{const o={isCloseable:!0,isSignUp:t,translations:Ie},s={onCloseDialogCallback(){(0,O.Fy)(Ve,d),ht.closingDialog("ConfirmationEmailDialog"),Ct.hideDialog(),Nt.rejectAuthenticationRequest(),a(D.qd.CANCELED)},async onResendConfirmationEmail(){await Tt.resendEmailVerification(e),await Tt.showConfirmationEmailDialog(e,!1).catch(a)}};Ct.displayDialog("ConfirmationEmailDialog",o,s)}))},async showAdminApprovalDialog(e){return new Promise(((t,i)=>{const a=()=>{(0,O._y)(d,Ve,{error:O.Mi.ACCESS_DENIED}),Nt.rejectAuthenticationRequest(),i(D.qd.CANCELED),Tt.closeCustomAuthenticationDialogs(!1)};Tt.showNotificationDialog("",`${Ie.applySuccess1} ${Ie.applySuccess2}`.replace("{0}",e),Ie.containerOk,a,a)}))},async showCustomAuthenticationDialog(e,t=!1){if(!C)throw new Error("popup unavailable");return new Promise((async(i,a)=>{Nt.assignRequestAuthenticationPromise(i,a);const o=Tt.registerToUserLogin((async()=>{Nt.resolveAuthenticationRequest({member:nt,sessionToken:rt,...t?{pages:await Tt.authorizeMemberPagesBySignedInstance(Ce())}:{}}),Tt.unRegisterToUserLogin(o),C.getCurrentLightboxId()===e&&C.close()}),"customAuthCbId");await Nt.openPopupPage(e,(()=>{Tt.unRegisterToUserLogin(o)})),Ct.hideDialog()}))},async closeCustomAuthenticationDialogs(e=!1){const t=C?.getCurrentLightboxId();t&&[tt,it].includes(t)&&(e&&Nt.preventCustomPopupCloseCallback(),await C.close(),Nt.allowCustomPopupCloseCallback())},getForgotPasswordToken(){return new URL((0,p.fU)(d)?Ve:d.location.href).searchParams.get("forgotPasswordToken")},shouldDisplayWelcomeDialog(){return K&&Oe},async verifyEmail(e){try{const t=i.get().emailConfirmationStateToken,a=await Et.request(Re({stateToken:t,code:e}),{signedInstance:Ce()});i.update((e=>({...e,emailConfirmationResponse:a?.data})))}catch(e){throw(0,O.E2)(e.response?.data)}},async resendVerificationCodeEmail(){ht.siteMembersEmailConfirmationOnResendCodeClick();const e=i.get().emailConfirmationStateToken,t=await bt(`${Je}/v1/proceed`,{method:"POST",headers:{"Content-Type":"application/json",authorization:Ce()},body:JSON.stringify({stateToken:e})});i.update((e=>({...e,emailConfirmationStateToken:t.stateToken})))},async showVerificationCodeDialog(e,t=!0){return new Promise((async(i,a)=>{s.interactionStarted(D.sH.VERIFICATION_CODE),ht.siteMembersEmailConfirmationNewMembersModalLoad(),Nt.assignRequestAuthenticationPromise(i,a);const o={language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:Nt.config?.isCloseable??!0,displayMode:"customPopup",email:e?.email,error:e?.error,translations:Ie,isAuthV2Enabled:!0,stateToken:e?.stateToken,isVerificationCodeDialogNewLogic:N["specs.thunderbolt.verificationCodeDialogNewLogic"]},n={async onResendVerificationCodeEmail(){ht.siteMembersEmailConfirmationOnResendCodeClick(),await bt(`${Je}/v1/proceed`,{method:"POST",headers:{"Content-Type":"application/json",authorization:Ce()},body:JSON.stringify({stateToken:e.stateToken})})},onCloseDialogCallback(){ht.closingDialog("VerificationCode"),(0,O.Fy)(Ve,d),Ct.hideDialog(),Nt.rejectAuthenticationRequest(),a(D.qd.CANCELED)},async onSubmitCallback(t){ht.siteMembersEmailConfirmationSendCodeClick();if(N["specs.thunderbolt.verificationCodeDialogNewLogic"])try{const i={stateToken:e.stateToken||"",code:t},a=await Et.request(Re(i),{signedInstance:Ce()});return a?.data}catch(e){const t=(0,O.E2)(e.response?.data);if(t===D.qd.CANCELED)return a(t);throw t}i(t)},onSuccessCallback:e=>{Ct.hideDialog(),i(e)}};s.interactionEnded(D.sH.VERIFICATION_CODE),Ct.displayDialog("VerificationCodeDialog",o,n,void 0,t)}))},async appWillMount(){V&&await Tt.getMemberDetails();switch(new URL(n.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":Tt.showLoginDialog();break;case"SignUpDialog":Tt.showSignUpDialog();break;case"RequestPasswordResetDialog":Tt.promptForgotPassword();break;case"ResetPasswordDialog":Tt.showResetPasswordDialog("faketoken");break;case"LoggedInResetPasswordDialog":Tt.showLoggedInResetPasswordDialog();break;case"WelcomeDialog":Tt.showWelcomeDialog();break;case"NoPermissionsToPageDialog":Tt.showNoPermissionsToPageDialog();break;case"NotificationDialog":Tt.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":Tt.showConfirmationEmailDialog("fakemember");break;case"VerificationCodeDialog":Tt.showVerificationCodeDialog({email:"testEmail@test.com"});break;case"ExpiredResetPasswordDialog":Tt.showNotificationDialog(Ie.passwordHasExpiredTitle,Ie.passwordHasExpiredText,Ie.passwordHasExpiredOk,(()=>Tt.promptForgotPassword(!1).then((()=>{const e=b.getParsedUrl();g.navigate(e.href)}))))}},pageWillUnmount({pageId:e}){[tt,it].includes(e)||Ct.hideDialog()},getSocialAuthComponentProps(){return(0,O._G)({config:e,viewerModel:n,sessionManager:r,bsiManager:R,handleSocialLoginResponse:Tt.handleSocialLoginResponse,isSocialAuthSupported:xe,captcha:A,userLanguage:u.userLanguage,reportBi:E.reportBi,reportSocialAuthStarted:Ot,useNewSocialFlow:!0,translations:Ie})},async getConnections(){const e={[D.ch.FACEBOOK]:!0,[D.ch.GOOGLE]:!0,[D.ch.APPLE]:!1};return Dt.getEnabledConnections(e).then((e=>e.map((({id:e,appDefId:t,displayName:i})=>({id:e,appDefId:t,name:i})))))},getLoginUrl(){if(yt&&N["specs.thunderbolt.shouldFetchLoginUrlByClientId"])return Dt.getLoginRedirectUrl()},getLogoutUrl(){if(yt)return Dt.getLogoutRedirectUrl()},getExternalBaseUrl(){return N["specs.thunderbolt.shouldUseExternalBaseUrl"]?Le:void 0},async register(e,t,i,a,o,n,r,c){n=n??!1;try{const l=await Dt.getCaptchaSettings();if(l.visible.signup&&"Enabled"!==N["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&!r&&!c?.otp&&!c?.verificationId)throw D.pH;s.interactionStarted(D.sH.CODE_SIGNUP),w.trackEvent((0,D.SU)(D.WW.ACTIONS.SIGNUP.SUBMIT));const u=C?.getCurrentLightboxId(),g=_.getCurrentRouteInfo()?.pageId,m=o||tt&&u&&tt===u||tt&&g&&tt===g,p=l.invisible.signup&&m?await _t(D.MA.SIGNUP):void 0,h=N["specs.thunderbolt.convertBirthdateToISOString"],S={profile:{...(0,O.y0)(i||{},h),privacyStatus:a,emails:[e]},loginId:{email:e},password:t,captchaTokens:[...r?[{Recaptcha:r}]:[],...p?[{InvisibleRecaptcha:p}]:[]]},b=await Et.request(function(e){var t=(0,G.d)(me,{_customField:oe,_customValue:se,_identityProfile:re,_listValue:ce,_mapValue:de}),i=t.toJSON,a=t.fromJSON,o=(0,G.d)(pe,{_commonCustomValue:te,_commonListValue:ie,_commonMapValue:ae,_customField:oe,_customValue:se,_identity:ne,_identityProfile:re,_listValue:ce,_mapValue:de}).fromJSON;function s(t){var a=t.host,s=i(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.RegisterV2",url:he({protoPath:"/v2/register",data:s,host:a}),data:s,transformResponse:o}}return s.fromReq=a,s.__isAmbassador=!0,s}(S),{signedInstance:Ce()}).then((e=>e.data)).catch((e=>{throw e.response?.data??e}));s.interactionEnded(D.sH.CODE_SIGNUP);const E=await Tt.getStateMachine(b,e),f=E?.additionalData?.protectedPages,P=(0,O.FB)(f),y=(0,O.$e)(E);if((0,O._y)(d,Ve,{sessionToken:E?.sessionToken})&&N["specs.thunderbolt.useNewPostLoginRedirect"])return(0,O.yw)();const v=await Tt.applySessionToken(E?.sessionToken,y,n&&!P),A=P??v;w.trackEvent((0,D.SU)(D.WW.ACTIONS.SIGNUP.SUCCESS)),w.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}});const I=E?.sessionToken;return{member:y,status:y.status,sessionToken:I,...n&&A?{pages:A}:{}}}catch(e){throw(0,O.NU)(e)?s.interactionEnded(D.sH.CODE_SIGNUP):w.trackEvent((0,D.SU)(D.WW.ACTIONS.SIGNUP.FAIL)),e}},async getStateMachine(e,t){const a=e?.state;if(a===fe.Gd.REQUIRE_OWNER_APPROVAL){if(ye){const e=Ne[D.$m.ADMIN_APPROVAL];e&&(Nt.rejectAuthenticationRequest(),C?.open(e,(()=>{throw(0,O._y)(d,Ve,{error:O.Mi.ACCESS_DENIED}),Nt.rejectAuthenticationRequest(),Tt.closeCustomAuthenticationDialogs(!1),new Error(D.qd.CANCELED)})).then((()=>{Ct.hideDialog(!0)})))}return Tt.showAdminApprovalDialog(t)}if(a===fe.Gd.REQUIRE_EMAIL_VERIFICATION){if(ye){const a=Ne[D.$m.EMAIL_CONFIRMATION];if(a){const o=await new Promise((t=>{i.update((t=>({...t,emailConfirmationStateToken:e?.stateToken??""})));C?.open(a,(()=>{const e=i.get().emailConfirmationResponse;t(e)})).then((()=>{Ct.hideDialog(!0)}))}));return this.getStateMachine(o,t)}}const a=N["specs.thunderbolt.verificationCodeDialogNewLogic"],o=e?.stateToken??"";if(a){const e=await Tt.showVerificationCodeDialog({email:t,stateToken:o});return Tt.getStateMachine(e,t)}return Tt.recurciveEmailVerification(t,e?.stateToken).then((e=>(Ct.hideDialog(),Tt.getStateMachine(e,t))))}return e},async recurciveEmailVerification(e,t,i,a,o){try{const s={stateToken:t||"",code:o??await Tt.showVerificationCodeDialog({email:e,stateToken:t,error:a},!i)};return(await Et.request(Re(s),{signedInstance:Ce()})).data}catch(i){if(i===D.qd.CANCELED)throw i;const a=i?.details?.applicationError?.code??"BAD_CODE";return Tt.recurciveEmailVerification(e,t,!0,a)}},async login(e,t,i,a=!1,o,s=!1){try{const n=await Dt.getCaptchaSettings();if(n.visible.login&&!i?.recaptchaToken&&!o?.otp&&!o?.verificationId)throw D.pH;w.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGIN.SUBMIT));const r=C?.getCurrentLightboxId(),c=_.getCurrentRouteInfo()?.pageId,l=s||it&&r&&it===r||it&&c&&it===c,u=n.invisible.login&&l?await _t(D.MA.LOGIN):void 0,g=[];i?.recaptchaToken&&g.push({Recaptcha:i?.recaptchaToken}),u&&g.push({InvisibleRecaptcha:u});const m={loginId:{email:e},password:t,captchaTokens:g},p=await Et.request(function(e){var t=(0,G.d)(le,{}),i=t.toJSON,a=t.fromJSON,o=(0,G.d)(pe,{_commonCustomValue:te,_commonListValue:ie,_commonMapValue:ae,_customField:oe,_customValue:se,_identity:ne,_identityProfile:re,_listValue:ce,_mapValue:de}).fromJSON;function s(t){var a=t.host,s=i(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.LoginV2",url:he({protoPath:"/v2/login",data:s,host:a}),data:s,transformResponse:o}}return s.fromReq=a,s.__isAmbassador=!0,s}(m),{signedInstance:Ce()}).then((e=>e.data)).catch((e=>{throw e.response?.data??e})),h=await Tt.getStateMachine(p,e),S=h?.additionalData?.protectedPages,b=(0,O.FB)(S),E=(0,O.$e)(h);if((0,O._y)(d,Ve,{sessionToken:h?.sessionToken})&&N["specs.thunderbolt.useNewPostLoginRedirect"])return(0,O.yw)();const f=await Tt.applySessionToken(h?.sessionToken,E,a&&!b),P=b??f,y=h?.sessionToken;return{sessionToken:y,member:E,...a?{pages:P}:{}}}catch(t){throw(0,O.qi)(t)||w.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),t?.details?.applicationError?.code===D.OQ.WAITING_APPROVAL&&Tt.showAdminApprovalDialog(e),t?.response?.data??t}}};return a.export({promptLogin:Tt.promptLogin,logout:Tt.logout,memberDetails:nt}),i.update((e=>({...e,shouldShowRenderingBlockingDialogs:e=>e.relativeUrl!==D.m5&&!(!Tt.getForgotPasswordToken()&&!Tt.shouldDisplayWelcomeDialog()),showRenderingBlockingDialogs:()=>{const e=Tt.getForgotPasswordToken();return e?ye?Tt.navigateToResetPasswordPage(e):Tt.showResetPasswordDialog(e):Tt.shouldDisplayWelcomeDialog()?Tt.showWelcomeDialog():void 0}}))),Tt}));var Me=i(16537),Ve=i(60950),Be=i(17840);const Fe=(0,a.Og)([_.Np],(e=>({getTpaHandlers(){const t=async(t,i,a)=>{const o=await e.getMemberDetails(!0);return o?a.appClientSpecMapData?.isWixTPA?{attributes:{firstName:o.firstName??"",lastName:o.lastName??"",privacyStatus:o.profilePrivacyStatus},name:o.memberName,email:o.loginEmail,id:o.id,owner:o.owner,status:o.status}:{id:o.id,owner:o.owner,status:o.status}:null},i=async(t,i={})=>{const{member:a}=await e.promptLogin({mode:i.mode,modal:i.modal});return{attributes:{firstName:a.firstName??"",lastName:a.lastName??"",privacyStatus:a.profilePrivacyStatus},name:a.memberName,email:a.loginEmail,id:a.id,owner:a.owner,status:a.status}};return{currentMember:t,smCurrentMember:t,logOutCurrentMember:(0,Be.V)(["site"],((t,i)=>{e.logout(i?.url)})),requestLogin:(0,Be.V)(["site"],i),smRequestLogin:(0,Be.V)(["site"],i)}}}))),qe=(0,a.Og)([_.Np,(0,a.KT)(o.Gp,_.UU),r.Ji],((e,{componentIds:t},i)=>({name:"site-members-components",pageWillMount(){const a=t.reduce(((t,i)=>({...t,[i]:e.getSocialAuthComponentProps()})),{});i.update(a)}}))),We=(0,a.Og)([(0,a.KT)(o.wk,_.UU)],(e=>({handle:async t=>{const{shouldShowRenderingBlockingDialogs:i,showRenderingBlockingDialogs:a}=e.get();return i(t)?(a(),null):t}}))),$e=e=>{e(_.Np,Me.$.AppWillMountHandler,Me.$.AppDidMountHandler).to(Ue),e(b.po.BlockingDialogs).to(We)},xe=e=>{e(Ve.dQ).to(Fe),e(Me.$.PageWillMountHandler).to(qe),e(Me.$.PageWillUnmountHandler).to((0,a.Og)([_.Np],(e=>({pageWillUnmount(t){return e.pageWillUnmount(t)}}))))}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/group_9.39b3b59e.chunk.min.js.map