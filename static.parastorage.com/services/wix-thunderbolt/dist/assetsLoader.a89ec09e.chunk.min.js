"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[569,5445],{33615:function(e,t,a){a.r(t),a.d(t,{ProtectedPagesApiSymbol:function(){return S},page:function(){return U},site:function(){return y}});var n,r=a(77748),s=a(20590),o=a(54563);!function(e){e.SM="SM",e.Pass="PASS",e.NONE="NONE"}(n||(n={}));const i=(0,r.Og)([(0,r.KT)(s._K,o.U),(0,r.KT)(s.YG,o.U),(0,r.KT)(s.wk,o.U)],((e,t,a)=>{const r=a=>{const r=e.pagesSecurity[a];return r&&r.requireLogin?n.SM:t.passwordProtected[a]||r&&r.passwordDigest?n.Pass:n.NONE};return{async handle(t){if(t.pageJsonFileName)return t;const s=t.pageId,{pagesMap:o,loginAndNavigate:i,authenticateUsingSitePassword:g,completedSitePasswordAuth:p}=a.get();if(o[s])return{...t,pageJsonFileName:o[s]};if(r("masterPage")===n.Pass&&!p)return g(t),null;const u=r(s);return u===n.NONE&&((e,t)=>{throw new Error(`we do not have authentication info for protected page ${e} page security: ${t}`)})(s,e.pagesSecurity[s]),i(t,u),null}}}));var g=a(71085),p=a(66397),u=a(19889),c=a(91994),d=a(12457),P=a(75396),l=a(32166),w=a(10553);const h=(0,r.Og)([(0,r.KT)(s.wk,o.U),(0,r.KT)(s.YG,o.U),(0,r.KT)(s._K,o.U),g.Ix,P.t7,(0,r.lq)(u.Np),(0,r.lq)(c.De),d.Tf,l.Ht,w.n],((e,{publicPageIds:t,pageUriSeoToRouterPrefix:a},{customNoPermissionsPageUriSeo:r,customNoPermissionsPageId:s},o,i,g,u,c,d,P)=>{const l=async(e,t)=>e===n.SM?(async()=>{let e;if(g)if(P["specs.thunderbolt.newAuthorizedPagesFlow"]){if(e=await g.requestAuthorizedPages(),e.success)return{authorizedPagesMap:e.pages,onProtectedPageNavigationComplete:async()=>{window.document.title=await c.getPageTitle()}}}else if(e=await g.requestAuthentication({}),e.success)return{authorizedPagesMap:await g.authorizeMemberPagesByToken(e.token)};return{authorizedPagesMap:{},authenticationResult:e}})():(async e=>u?u.promptPagePasswordDialog(e):{authorizedPagesMap:{}})(t),w=async(e,t,n=!1)=>{if(r&&n){const t=`${a[r]?`./${a[r]}/`:"./"}${r}`,n=encodeURIComponent(JSON.stringify({restrictedPageId:e.pageId,restrictedPagePath:(e.relativeEncodedUrl??"").replace("./","/")}));return o.navigate(`${t}?appSectionParams=${n}`)}if(g&&"SM"===t){const e=()=>{i.isLandingOnProtectedPage()&&o.navigate("./")};return g.showNoPermissionsToPageDialog(e),!1}return!!i.isLandingOnProtectedPage()&&o.navigate("./")};async function h(t){if(!u)return;const{authorizedPagesMap:a,onComplete:n}=await u.promptSitePasswordDialog();e.update((e=>({...e,pagesMap:Object.assign(e.pagesMap,a),completedSitePasswordAuth:!0}))),await o.navigate(t.parsedUrl.href),n?.()}const f=async(a,n)=>{const r=a.pageId;try{const{authorizedPagesMap:g,authenticationResult:u,onProtectedPageNavigationComplete:c}=await l(n,r);if(e.update((e=>({...e,pagesMap:Object.assign(e.pagesMap,g)}))),u?.reason===p.qd.CANCELED)return!!i.isLandingOnProtectedPage()&&o.navigate("./");if(g[r]){const e=await o.navigate(a.parsedUrl.href);return c?.(),e}{const r=t.includes(s),o=Boolean(e.get().pagesMap[s]);return w(a,n,r||o)}}catch(e){return d.captureError(e,{tags:{feature:"protectedPage"}}),w(a,n)}};return e.update((()=>({loginAndNavigate:f,authenticateUsingSitePassword:h,completedSitePasswordAuth:!1,pagesMap:{}}))),{appWillMount:async()=>{}}}));var f=a(16537),M=a(60950);const m=(0,r.Og)([(0,r.KT)(s.wk,o.U),u.Np],((e,t)=>({getTpaHandlers(){return{authorizeMemberPages:async()=>{const a=await t.authorizeMemberPagesByCookie();e.update((e=>({...e,pagesMap:{...e.pagesMap,...a}})))}}}})));const N=(0,r.Og)([(0,r.KT)(s.wk,o.U)],(function(e){return{getPageJsonFileName(t){return e.get()?.pagesMap[t]??null},getProtectedPages(){return{...e.get()?.pagesMap??{}}}}})),S=Symbol("ProtectedPagesApiSymbol"),y=e=>{e(g.po.Protected).to(i),e(f.$.AppWillMountHandler).to(h),e(S).to(N)},U=e=>{e(M.dQ).to(m)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/assetsLoader.a89ec09e.chunk.min.js.map